function CalculateYAxis(t){function e(t){var e=5;return e=t<=10?5:t<=15?10:t<=20?15:t<=50?25:t<=100?50:t<=300?100:t<=800?400:t<=1e3?500:1e3,CalculateMultiple(Math.floor(t/3),e,!0)}var n=Math.min.apply(null,t),a=Math.max.apply(null,t),i=a-n,o=e(i),r=CalculateMultiple(n,o,!1),l=CalculateMultiple(a,o,!0),d=l-r,v=1;d%2==0?v=2:d%3==0&&(v=3);for(var u=[r],f=1;f<v;f++)u.push(r+f*d/v);return u.push(l),u}function CalculateMultiple(t,e,n){for(var a=n?1:-1;;){if(t%e===0)return t;t+=a}}function CalculateXAxis(t,e){if(t<1||e<0)return{divider:1,offset:0};for(var n=50,a=e/(t-1),i=1;a<n;)i*=2,a=e/((t-1)/i);return{divider:i,offset:a}}function TransformCoordinate(t,e,n,a,i,o){for(var r=[],l=e/(i-a),d=0;d<o.length;d++)if(null!=o[d]){var v=t/(n-1)*d,u=(i-o[d])*l;r.push({x:v,y:u})}else r.push(null);return r}function LinearDiagram(t,e){function n(t,e){var n={};n.distance2=2500,n.points=[];for(var a=0;a<u.Data.length;a++)for(var i=0;i<u.Data[a].Points.length;i++){var o=u.Data[a].Points[i],r=Math.pow(o.x-t,2)+Math.pow(o.y-e,2);r<=n.distance2&&(r<n.distance2?(n.distance2=r,n.points=[{data:u.Data[a],index:i,coordinate:o}]):n.points.push({data:u.Data[a],index:i,coordinate:o}))}return n}var a=new SvgGraphic(t),i=!1,o=null,r=null,l=[],d=null,v=null,u={Data:[],Axis:[]};for(var f in e)u[f]=e[f];var h={clear:"transparent",service:"#A9A9A9",infoboxfill:"#464646",infoboxtext:"#fff"};this.Draw=function(t,e){l=[];for(var n in e)l=l.concat(e[n].DataSet);d=CalculateYAxis(l),u.Axis=t,u.Data=e,m()};var s=function(){r={top:50,bottom:a.paper.getBoundingClientRect().height-50,left:50,right:a.paper.getBoundingClientRect().width-30,width:a.paper.getBoundingClientRect().width-30-50,height:a.paper.getBoundingClientRect().height-50-50},v=CalculateXAxis(u.Axis.length||0,r.width)};s();var g=new SvgGroup(a),S=new SvgGroup(a),c=new SvgGroup(a),p=new SvgGroup(a),x=new SvgGroup(a),w=new SvgGroup(a);S.Add(c),S.Add(p),S.Add(x),S.Add(w);var A=new SvgGroup(a),D=new SvgGroup(a),C=new SvgGroup(a);A.Add(D),A.Add(C);var P=function(){y(),G(),L()},m=function(){g.Clear(),c.Clear(),p.Clear(),x.Clear(),w.Clear(),D.Clear(),C.Clear(),s(),P()},y=function(){for(var t=u.Data.length-1,e=0;t>=0;t--,e++){var n=r.right-30-60*e,i=new SvgText(a,n,r.top-20,u.Data[t].Title);i.SetBold(!0),i.SetFill(h.service),i.Centerize(n,r.top-20);var o=i.Element.getBoundingClientRect(),l="M"+(n-o.width/2)+","+(r.top-12)+" L"+(n+o.width/2)+","+(r.top-12),d=new SvgPath(a,l);d.SetStroke(4,u.Data[t].Color),g.Add(i),g.Add(d)}},G=function(){var t=new SvgPath(a,SvgPath.GeneratePolyline([{x:r.left,y:r.bottom},{x:r.right,y:r.bottom}]));t.SetFill(h.clear),t.SetStroke(1,h.service),c.Add(t);for(var e=1,n=d.length;e<n;e++){var i=r.bottom-r.height/(d.length-1)*e,o=new SvgPath(a,SvgPath.GeneratePolyline([{x:r.left,y:i},{x:r.right,y:i}]));o.SetFill(h.clear),o.SetStroke(1,h.service),o.Element.setAttribute("stroke-dasharray","5, 5"),c.Add(o);var l=new SvgText(a,r.left,i,d[e]);l.Centerize(r.left-15,i),l.SetFill(h.service),p.Add(l)}for(var e=0,n=u.Axis.length;e<n;e+=v.divider){var f=r.left+r.width/(u.Axis.length-1)*e;if(e>0&&e<u.Axis.length-1){var s=new SvgPath(a,SvgPath.GeneratePolyline([{x:f,y:r.top},{x:f,y:r.bottom+10}]));s.SetFill(h.clear),s.SetStroke(1,h.service),x.Add(s)}var l=new SvgText(a,f,r.bottom,u.Axis[e]);l.Centerize(f,r.bottom+20),l.SetFill(h.service),w.Add(l)}},L=function(){for(var t=0,e=u.Data.length;t<e;t++){for(var n=TransformCoordinate(r.width,r.height,u.Axis.length,d[0],d[d.length-1],u.Data[t].DataSet),i=0;i<n.length;i++)null!=n[i]&&(n[i].x+=r.left,n[i].y+=r.top);u.Data[t].Points=n;var o=new SvgPath(a,SvgPath.GeneratePolyline(u.Data[t].Points));o.SetFill(h.clear),o.SetStroke(3,u.Data[t].Color),D.Add(o)}for(var t=0,e=u.Data.length;t<e;t++)for(var i=0;i<u.Data[t].Points.length;i++){var l=u.Data[t].Points[i],f=i%v.divider===0;if(null!=l){var s=new SvgCircle(a,l.x,l.y,3);s.SetFill(u.Data[t].Color),f&&(s.SetRadius(5),s.SetStroke(2,"#FFF")),C.Add(s)}}},F=new SvgInfoBox(a,100,50,h.infoboxfill,h.infoboxtext);a.paper.addEventListener("mouseover",function(t){i=!0}),a.paper.addEventListener("mouseout",function(t){i=!1}),a.paper.addEventListener("wheel",function(t){t.deltaY>0?F.NextData():t.deltaY<0&&F.PreviousData()}),a.paper.addEventListener("mousemove",function(t){if(i&&u.Data&&u.Data.length>0){var e=n(t.offsetX,t.offsetY);if(e.points.length){var a=e.points[0].coordinate;o=e;var r=!(a.y<100),l=[];for(var d in e.points)l.push({title:e.points[d].data.Title,text:e.points[d].data.DataSet[e.points[0].index],color:e.points[d].data.Color});F.Show(a.x,a.y,l,r)}else o=null,F.Hide()}}),window.addEventListener("resize",function(t){m()})}function SvgInfoBox(t,e,n,a,i){var o=null,r=null,l=null,d=null,v=null,u=[],f=0,h=function(){v=new SvgRadialGradient(t,[{color:"#fff"},{color:a}]),o=new SvgGroup(t),r=new SvgPath(t,"M0,0 L0,0"),v.FillTo(r.Element),l=new SvgText(t,0,0,""),l.SetFill(i),l.SetFontSize("11pt"),l.SetBold(!0),d=new SvgText(t,0,0,""),d.SetFill(i),d.SetFontSize("10pt"),o.Add(r),o.Add(l),o.Add(d),o.Hide()};this.Show=function(t,a,i,h){u=i,r.SetPath(GenerateSvgPathInfobox(t,a,e,n,h)),h?v.SetPosition("50%","100%","50%","100%","50%"):v.SetPosition("50%","0%","50%","0%","50%"),f=0,this.DataUpdate(0);var s=h?-53:37;l.Centerize(t,a+s);var g=h?-35:55;d.Centerize(t,a+g),o.Show()},this.DataUpdate=function(t){t>0&&t<u.length?t:0;l.SetText(u[t].title),d.SetText(u[t].text),v.SetColors([{color:u[t].color},{color:a}])},this.PreviousData=function(){0!==u.length&&(f--,f<0&&(f=u.length-1),this.DataUpdate(f))},this.NextData=function(){0!==u.length&&(f++,f>=u.length&&(f=0),this.DataUpdate(f))},this.Hide=function(){u=[],o.Hide()},h()}GenerateSvgPathInfobox=function(t,e,n,a,i){var o=10,r=15,l=5,d=t-n/2,v=0,u=t+n/2,f=0;i?(v=e-(5+r+a),f=e-(5+r)):(v=e+(5+r),f=e+(5+r+a));var h="M"+(d+l)+","+v;return i||(h+=" L"+(t-o)+","+v,h+=" L"+t+","+(v-r),h+=" L"+(t+o)+","+v),h+=" L"+(u-l)+","+v,h+=" A"+l+" "+l+", 0, 0, 1,"+u+" "+(v+l),h+=" L"+u+","+(f-l),h+=" A"+l+" "+l+", 0, 0, 1,"+(u-l)+" "+f,i&&(h+=" L"+(t+o)+","+f,h+=" L"+t+","+(f+r),h+=" L"+(t-o)+","+f),h+=" L"+(d+l)+","+f,h+=" A"+l+" "+l+", 0, 0, 1,"+d+" "+(f-l),h+=" L"+d+","+(v+l),h+=" A"+l+" "+l+", 0, 0, 1,"+(d+l)+" "+v,h+=" Z"};
function StrGrid(n,t){function e(n){var t='<tr class="str-grid__head-row">';for(var e in n)t+='<td class="str-grid__head-cell">'+n[e].name+"</td>";return t+="</tr>"}function a(n,t){var e='<tr class="str-grid__body-row">';for(var a in t){var r=n[t[a].index];e+='<td class="str-grid__body-cell">'+(void 0!=r?r:"")+"</td>"}return e+="</tr>"}var r={InitPaginator:!0,CountRow:[10,30,50],Data:[],ChartPaginator:!1,Columns:[{name:"Name",index:"name"}]};for(var l in r)void 0==t[l]&&(t[l]=r[l]);var i=["#00C8E2","#FF5D4F","#BDD30F","#FCA32B","#04E0DE","#FB68AF","#0068AF"],o=!1,d=!0,s=null,u=0,c=10,m=null,h=null,p=null,f=null,g=null,C=null,v=null,_=null,y=null,E=null,w=null,b=null,D=null,x=null,N=null,H=null,L=null,F=function(){m=document.getElementById(n),m.className="str-grid",h=document.createElement("div"),h.className="str-grid__head-container",p=document.createElement("div"),p.className="str-grid__body-container",f=document.createElement("table"),f.className="str-grid__head-table",g=document.createElement("table"),g.className="str-grid__body-table",C=document.createElement("colgroup"),v=document.createElement("colgroup"),_=document.createElement("tbody"),y=document.createElement("tbody"),m.appendChild(h),m.appendChild(p),h.appendChild(f),p.appendChild(g),f.appendChild(C),f.appendChild(_),g.appendChild(v),g.appendChild(y),t.InitPaginator&&I(),J()&&T()},I=function(){E=document.createElement("div"),E.className="str-grid__paginator-container",w=document.createElement("button"),w.className="str-grid__icon str-grid__paginator-previous",b=document.createElement("button"),b.className="str-grid__icon str-grid__paginator-next",D=document.createElement("span"),D.className="str-grid__paginator-counter",m.appendChild(E),E.appendChild(w),E.appendChild(D),E.appendChild(b),w.addEventListener("click",function(n){j()}),b.addEventListener("click",function(n){q()}),R()},T=function(){o=!0,N=document.createElement("div"),N.className="str-grid__chart-container";var n=m.offsetHeight;null!=E&&(n-=E.offsetHeight),N.style.height=n+"px",N.style.display="none",H=document.createElementNS("http://www.w3.org/2000/svg","svg"),H.setAttribute("class","str-grid__chart-content"),L=document.createElement("input"),L.setAttribute("type","checkbox"),L.className="str-grid__chart-grid-toggler str-grid__icon",L.addEventListener("change",function(n){K()}),N.appendChild(H),m.insertBefore(N,E),m.appendChild(L),s=new LinearDiagram(H,{})},A=function(){var n=z(t.Columns);_.innerHTML=e(t.Columns),C.innerHTML=n,v.innerHTML=n;var a=m.offsetHeight-h.offsetHeight;null!=E&&(a-=E.offsetHeight),p.style.height=a+"px"},P=function(n){var e=null;e=t.InitPaginator?S(n*c,c):S();for(var r="",l=0;l<e.length;l++)r+=a(e[l],t.Columns);y.innerHTML=r,f.offsetWidth!==g.offsetWidth&&(f.style.width=g.offsetWidth+"px"),null!==s&&M(e)},B=function(){var n=null;n=t.InitPaginator?S(u*c,c):S(),M(n)},M=function(n){for(var e=[],a=[],r="",l=0,o=0,d=t.Columns.length;o<d;o++)if(t.Columns[o].chartData){var u="#000";u=t.Columns[o].chartColor?t.Columns[o].chartColor:i[l++],e.push({index:t.Columns[o].index,Title:t.Columns[o].name,Color:u,DataSet:[]})}else t.Columns[o].chartAxis&&(r=t.Columns[o].index);for(var o=0,c=n.length;o<c;o++){a.push(n[o][r]);for(var m=0,h=e.length;m<h;m++){var p=n[o][e[m].index];void 0!==p?e[m].DataSet.push(p):e[m].DataSet.push(null)}}s.Draw(a,e)},S=function(n,e){return null==n&&(n=0,e=t.Data.length),t.Data.slice(n,n+e)},W=function(){return Math.ceil(t.Data.length/c)},k=function(){t.InitPaginator&&(D.innerText=u+1+" / "+W())},R=function(){var n=document.createElement("select");n.className="str-grid__paginator-select-count-row";for(var e in t.CountRow){var a=document.createElement("option");a.value=t.CountRow[e],a.innerText=t.CountRow[e],n.appendChild(a)}n.addEventListener("change",function(t){G(parseInt(n.value))}),x=n,E.appendChild(n)},G=function(n){c=n,u>=W()&&(u=W()-1),P(u),k()},j=function(){u>0&&(u--,P(u),k())},q=function(){u+1<W()&&(u++,P(u),k())},z=function(){var n=0;for(var e in t.Columns)t.Columns[e].Width||n++;var a=m.offsetWidth/n;a<10&&(a=10);var r="";for(var e in t.Columns)r+='<col width="'+(t.Columns[e].width?t.Columns[e].width:a)+'" />';return r},J=function(){for(var n in t.Columns)if(t.Columns[n].chartData)return!0;return!1},K=function(){d?(h.style.display="none",p.style.display="none",N.style.display="block",d=!1,B()):(h.style.display="",p.style.display="",N.style.display="none",d=!0)};F(),A(),P(0),k()}
function SvgGraphic(t){if(this.paper=null,this.domId=null,"string"==typeof t)this.paper=document.getElementById(t),this.domId=t;else{if("object"!=typeof t||!t.tagName||"svg"!==t.tagName)throw Error("Ошибка: В конструктор SvgGraphic не правильно переданы аргументы!");this.paper=t,this.domId="svg_"+Math.floor(1e3*Math.random())}this.GetUniqId=function(){return this.GetUniqId.counter++,this.domId+"_"+this.GetUniqId.counter},this.GetUniqId.counter=0,this.GetDefs=function(){return this.GetDefs.defs||(this.GetDefs.defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this.paper.insertBefore(this.GetDefs.defs,this.paper.firstChild)),this.GetDefs.defs},this.GetDefs.defs=null}function SvgElement(t,e){this.Element=document.createElementNS(t.paper.namespaceURI,e),t.paper.appendChild(this.Element)}function SvgPath(t,e){SvgElement.apply(this,[t,"path"]),this.Element.setAttribute("d",e),this.SetFill("#000")}function SvgCircle(t,e,i,n){SvgElement.apply(this,[t,"circle"]),this.Element.setAttribute("cx",e),this.Element.setAttribute("cy",i),this.Element.setAttribute("r",n),this.SetFill("#000")}function SvgText(t,e,i,n){SvgElement.apply(this,[t,"text"]),this.SetPosition(e,i),this.SetFontSize(12),this.SetFont("Verdana"),this.SetText(n)}function SvgGroup(t){this.Element=document.createElementNS(t.paper.namespaceURI,"g"),t.paper.appendChild(this.Element)}function SvgLinearGradient(t,e){var i=this;i.uniqId=null,i.element=document.createElementNS(t.paper.namespaceURI,"linearGradient"),t.GetDefs().appendChild(i.element);var n=function(){i.uniqId=t.GetUniqId(),i.element.setAttribute("id",i.uniqId);for(var n in e){var o=e[n],r=document.createElementNS(t.paper.namespaceURI,"stop");o.color&&r.setAttribute("stop-color",o.color),o.offset&&r.setAttribute("offset",o.offset),i.element.appendChild(r)}};this.FillTo=function(t){t.setAttribute("fill","url(#"+i.uniqId+")")},n()}function SvgRadialGradient(t,e){var i=this;i.uniqId=null,i.element=document.createElementNS(t.paper.namespaceURI,"radialGradient"),t.GetDefs().appendChild(i.element);var n=function(){i.uniqId=t.GetUniqId(),i.element.setAttribute("id",i.uniqId),o(e)};this.FillTo=function(t){t.setAttribute("fill","url(#"+i.uniqId+")")},this.SetPosition=function(t,e,n,o,r){i.element.setAttribute("cx",t),i.element.setAttribute("cy",e),i.element.setAttribute("fx",n),i.element.setAttribute("fy",o),i.element.setAttribute("r",r)},this.SetColors=function(t){for(;i.element.firstChild;)i.element.removeChild(i.element.firstChild);o(t)};var o=function(e){for(var n=0;n<e.length;n++){var o=e[n],r=document.createElementNS(t.paper.namespaceURI,"stop");if(o.color&&r.setAttribute("stop-color",o.color),o.offset)r.setAttribute("offset",o.offset);else{var s=100/(e.length-1)*n;r.setAttribute("offset",s+"%")}void 0!=o.opacity&&r.setAttribute("stop-opacity",o.opacity),i.element.appendChild(r)}};n()}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),SvgElement.prototype.SetStroke=function(t,e){this.Element.setAttribute("stroke-width",t),this.Element.setAttribute("stroke",e)},SvgElement.prototype.SetFill=function(t){this.Element.setAttribute("fill",t)},SvgElement.prototype.Hide=function(){this.Element.setAttribute("visibility","hidden")},SvgElement.prototype.Show=function(){this.Element.setAttribute("visibility","visible")},SvgPath.prototype=Object.create(SvgElement.prototype),SvgPath.prototype.constructor=SvgElement,SvgPath.prototype.SetPath=function(t){this.Element.setAttribute("d",t)},SvgPath.GeneratePolyline=function(t){var e="M";for(var i in t){var n=t[i];null!=n&&(e+=n.x+","+n.y+" ")}return e},SvgPath.GenerateRoundRectangle=function(t,e,i,n,o,r){var s=t+i,l=e+n,u="M"+(t+o)+","+e;return u+=" L"+(s-o)+","+e,u+=" A"+o+" "+o+", 0, 0, 1,"+s+" "+(e+o),u+=" L"+s+","+(l-o),u+=" A"+o+" "+o+", 0, 0, 1,"+(s-o)+" "+l,u+=" L"+(t+o)+","+l,u+=" A"+o+" "+o+", 0, 0, 1,"+t+" "+(l-o),u+=" L"+t+","+(e+o),u+=" A"+o+" "+o+", 0, 0, 1,"+(t+o)+" "+e,r&&(u+=" Z"),u},SvgCircle.prototype=Object.create(SvgElement.prototype),SvgCircle.prototype.constructor=SvgElement,SvgCircle.prototype.SetPosition=function(t,e){this.Element.setAttribute("cx",t),this.Element.setAttribute("cy",e)},SvgCircle.prototype.SetRadius=function(t){this.Element.setAttribute("r",t)},SvgCircle.prototype.AnimateRadius=function(t){var e=parseInt(this.Element.getAttribute("r"));if(e<t){this.Element.setAttribute("r",e+1);var i=this;window.requestAnimFrame(function(){i.AnimateRadius(t)})}},SvgText.prototype=Object.create(SvgElement.prototype),SvgText.prototype.constructor=SvgElement,SvgText.prototype.SetText=function(t){this.Element.textContent=t},SvgText.prototype.SetPosition=function(t,e){this.Element.setAttribute("x",t),this.Element.setAttribute("y",e)},SvgText.prototype.SetFont=function(t){this.Element.setAttribute("font-family",t)},SvgText.prototype.SetFontSize=function(t){this.Element.setAttribute("font-size",t)},SvgText.prototype.Centerize=function(t,e){var i=this.Element.getBoundingClientRect();this.SetPosition(t-i.width/2,e+i.height/4)},SvgText.prototype.SetBold=function(t){t?this.Element.setAttribute("font-weight","bold"):this.Element.setAttribute("font-weight","normal")},SvgGroup.prototype.Add=function(t){this.Element.appendChild(t.Element)},SvgGroup.prototype.Remove=function(t){this.Element.removeChild(t.Element)},SvgGroup.prototype.Clear=function(){for(;this.Element.firstChild;)this.Element.removeChild(this.Element.firstChild)},SvgGroup.prototype.Hide=function(){this.Element.setAttribute("visibility","hidden")},SvgGroup.prototype.Show=function(){this.Element.setAttribute("visibility","visible")};